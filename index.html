<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Mr.Web!</title>
    <style>
        body {
            background-color: SeaGreen;
            overflow-x: hidden;
            width: 100%;
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        /*... (manteniendo todos los estilos previos) ...*/

        .link-container a {
            /* Añadimos solo las propiedades necesarias para el margen */
            word-wrap: break-word;
            overflow-wrap: break-word;
        }

        /*... (el resto de los estilos permanecen igual) ...*/
    </style>
</head>
<body>
    <!-- El resto del cuerpo permanece sin cambios -->
    <h1 class="page-title">Mr.Web!</h1>
    <h2 class="header-text">Encabezado del Contenido</h2>

    <div class="button-container">
        <button class="button1" id="selectFileButton">Seleccionar Archivo</button>
        <input type="file" id="fileInput" accept=".txt" style="display:none;">
    </div>

    <div id="content" class="container">
        <h3 class="subheader-text" id="fileName">#######</h3>
        <h4 class="minorheader-text" id="linkCount">[0]</h4>
        <h5 class="additional-header-text" id="linkIndex"></h5>
        <div id="links"></div>
    </div>
<script>
    // El script permanece sin cambios
    let showHeaders = { h1: 'yes', h2: 'none', h3: 'yes', h4: 'none', h5: 'yes' };
    let showNumbering = 'none';

    let selectedFile = null;

    function updateVisibility() {
        for (let tag in showHeaders) {
            document.querySelectorAll(tag).forEach(el => {
                el.style.display = showHeaders[tag] === 'yes' ? '' : 'none';
            });
        }
    }

    document.addEventListener('DOMContentLoaded', updateVisibility);

    document.getElementById('selectFileButton').addEventListener('click', function() {
        document.getElementById('fileInput').click();
    });

    document.getElementById('fileInput').addEventListener('change', function() {
        const fileInput = document.getElementById('fileInput');
        selectedFile = fileInput.files[0];

        let fileName = selectedFile.name;
        fileName = fileName.substring(0, fileName.lastIndexOf('.')) || fileName;
        document.getElementById('fileName').textContent = fileName;

        // Limpiar los contenidos anteriores
        document.getElementById('links').innerHTML = '';
        document.getElementById('linkIndex').innerHTML = '';
        document.getElementById('linkCount').textContent = '[0]';

        if (selectedFile) {
            const reader = new FileReader();

            reader.onload = function(e) {
                const content = e.target.result;
                const linkRegex = /(?:https?|ftp):\/\/[\n\S]+/g;
                const links = content.match(linkRegex);

                if (links) {
                    links.sort((a, b) => {
                        const aDomain = (new URL(a)).hostname.replace(/^www\./, '');
                        const bDomain = (new URL(b)).hostname.replace(/^www\./, '');
                        return aDomain.localeCompare(bDomain);
                    });

                    const linksHTML = links.map((url, index) => {
                        const urlWithoutProtocol = url.replace(/https?:\/\/(www\.)?/, '');
                        const shortUrl = urlWithoutProtocol.split('/')[0]; // Solo la primera barra
                        return `
                        <div class="link-container" id="${shortUrl.replace(/[^\w]/g, '_')}" style="margin-top: 3px;">
                            ${showNumbering === 'yes' ? `<span class="link-number">${index + 1}.</span>` : ''}
                            <a href="${url}" target="_blank" onclick="event.preventDefault(); window.open('${url}', '_blank');">${url}</a>
                        </div>`;
                    }).join('');

                    document.getElementById('links').innerHTML = linksHTML;

                    document.getElementById('linkCount').textContent = `[${links.length}]`;

                    const baseUrls = links.reduce((acc, link) => {
                        const url = new URL(link);
                        const baseUrl = url.hostname.replace(/^www\./, '').toLowerCase();
                        acc[baseUrl] = acc[baseUrl] || [];
                        acc[baseUrl].push(url.href);
                        return acc;
                    }, {});

                    const indexHTML = Object.keys(baseUrls)
                        .sort()
                        .map(baseUrl => {
                            const shortBaseUrl = baseUrl.replace(/[^\w]/g, '_');
                            return `<a href="javascript:void(0)" onclick="scrollToSection('${shortBaseUrl}')">${baseUrl} [${baseUrls[baseUrl].length}]</a>`;
                        })
                        .join('');

                    document.getElementById('linkIndex').innerHTML = `Índice [${links.length}]${indexHTML}`;

                    const linkContainers = document.querySelectorAll('.link-container');
                    linkContainers.forEach((container, i) => {
                        if ((i + 1) % 20 === 0) {
                            const topLink = document.createElement('a');
                            topLink.href = 'javascript:void(0)';
                            topLink.className = 'top-link';
                            topLink.textContent = '#######';
                            topLink.onclick = () => document.querySelector('.page-title').scrollIntoView({ behavior: 'smooth' });
                            container.insertAdjacentElement('afterend', topLink);
                        }
                    });

                    updateVisibility();
                }
            };

            reader.readAsText(selectedFile);
        }
    });

    function scrollToSection(id) {
        const element = document.getElementById(id);
        if (element) {
            element.scrollIntoView({ behavior: 'smooth', block: 'start' });
        }
    }
</script>
</body>
</html>
